from stable_baselines3 import PPO
from stable_baselines3.common.utils import set_random_seed

import numpy as np

set_random_seed(0)

obs = [1.5808817, 1.5740385, 1.5672851, 1.5606177, 1.5540376, 1.5475404, 1.5411258, 1.5347978, 1.5285442, 1.5223768, 1.5162803, 1.5102679, 1.5043279, 1.4984604, 1.492668, 1.4869534, 1.4813075, 1.475731, 1.4702235, 1.4647876, 1.4594171, 1.4541163, 1.4488779, 1.4437037, 1.4385958, 1.43355, 1.4285704, 1.4236476, 1.418787, 1.4139881, 1.4092442, 1.4045588, 1.3999335, 1.3953668, 1.3908515, 1.3863953, 1.3819937, 1.3776423, 1.3733495, 1.3691058, 1.3649156, 1.3607768, 1.3566864, 1.3526487, 1.348659, 1.3447164, 1.3408247, 1.3369789, 1.333184, 1.3294315, 1.3257301, 1.3220708, 1.3184558, 1.3148893, 1.3113626, 1.3078815, 1.3044466, 1.30105, 1.2976978, 1.2943854, 1.2911177, 1.287887, 1.2847012, 1.281552, 1.2784417, 1.2753748, 1.2723427, 1.2693514, 1.2663969, 1.2634792, 1.2606013, 1.2577586, 1.2549528, 1.2521825, 1.2494507, 1.2467513, 1.244089, 1.2414603, 1.2388684, 1.2363101, 1.2337841, 1.2312913, 1.2288322, 1.2264085, 1.2240161, 1.2216568, 1.2193266, 1.2170331, 1.2147684, 1.2125365, 1.210333, 1.2081637, 1.2060229, 1.203914, 1.2018336, 1.1997868, 1.1977658, 1.1957749, 1.1938152, 1.1918815, 1.189979, 1.1881042, 1.18626, 1.1844419, 1.1826506, 1.1808882, 1.1791565, 1.1774483, 1.1757668, 1.1741132, 1.1724895, 1.1708881, 1.1693169, 1.1677709, 1.1662511, 1.1647569, 1.16329, 1.1618471, 1.1604306, 1.1590397, 1.1576717, 1.1563321, 1.1550156, 1.1537255, 1.1524581, 1.1512176, 1.1499996, 1.1488072, 1.147639, 1.1464964, 1.145376, 1.1442797, 1.143206, 1.1421578, 1.141132, 1.1401318, 1.1391526, 1.1381965, 1.1372658, 1.136356, 1.1354707, 1.1346064, 1.1337681, 1.1329505, 1.1321564, 1.1313856, 1.1306362, 1.1299074, 1.1292037, 1.1285222, 1.1278601, 1.127223, 1.1266061, 1.1260135, 1.125442, 1.1248945, 1.1243643, 1.1238579, 1.1233736, 1.1229113, 1.1224715, 1.1220531, 1.1216567, 1.1212785, 1.1209247, 1.1205914, 1.1202813, 1.1199917, 1.1197215, 1.1194758, 1.1192505, 1.119046, 1.118864, 1.1187012, 1.1185598, 1.118441, 1.1183411, 1.1182665, 1.1182122, 1.1181772, 1.1181619, 1.1181742, 1.1182015, 1.1182532, 1.1183248, 1.1184188, 1.1185325, 1.1186692, 1.1188254, 1.119006, 1.1192064, 1.1194263, 1.1196707, 1.1199331, 1.1202185, 1.1205286, 1.1208547, 1.1212058, 1.1215746, 1.1219702, 1.1223836, 1.1228182, 1.123278, 1.1237574, 1.1242586, 1.1247828, 1.125327, 1.1258944, 1.126482, 1.1270946, 1.1277293, 1.1283857, 1.1290618, 1.129762, 1.1304822, 1.1312284, 1.1319964, 1.1327865, 1.1336007, 1.1344353, 1.1352924, 1.1361736, 1.1370753, 1.1380055, 1.1389548, 1.1399299, 1.1409241, 1.1419449, 1.1429893, 1.1440561, 1.145148, 1.1462637, 1.147402, 1.1485648, 1.1497542, 1.1509652, 1.1522019, 1.1534643, 1.1547496, 1.1560601, 1.1573949, 1.1587582, 1.1601413, 1.1615541, 1.1629907, 1.1644535, 1.1659424, 1.1674563, 1.1689967, 1.1705649, 1.1721584, 1.1737782, 1.1754274, 1.1770998, 1.1788039, 1.1805286, 1.1822869, 1.184072, 1.1858833, 1.1877232, 1.189593, 1.1914877, 1.193414, 1.1953706, 1.1973536, 1.1993672, 1.2014089, 1.2034867, 1.2055886, 1.2077243, 1.2098858, 1.2120786, 1.2143083, 1.2165626, 1.2188513, 1.2211761, 1.22353, 1.2259134, 1.2283331, 1.2307824, 1.2332671, 1.2357844, 1.2383374, 1.2409247, 1.2435482, 1.2462035, 1.2488924, 1.2516177, 1.2543825, 1.2571802, 1.2600145, 1.2628863, 1.2657955, 1.2687411, 1.2717228, 1.2747471, 1.2778109, 1.2809107, 1.2840532, 1.2872272, 1.290449, 1.2937137, 1.2970157, 1.3003597, 1.3037463, 1.3071747, 1.310648, 1.3141612, 1.3177239, 1.3213248, 1.3249736, 1.3286684, 1.3324082, 1.3361986, 1.3400313, 1.3439162, 1.3478416, 1.351823, 1.3558517, 1.3599281, 1.3640568, 1.368239, 1.3724697, 1.3767565, 1.3810956, 1.3854872, 1.3899324, 1.3944339, 1.398991, 1.4036047, 1.4082788, 1.4130094, 1.4177965, 1.4226438, 1.4275526, 1.4325236, 1.4375557, 1.4426491, 1.4478066, 1.4530345, 1.4583211, 1.4636811, 1.4691039, 1.474594, 1.480153, 1.4857868, 1.4914923, 1.4972671, 1.5031147, 1.5090412, 1.5150375, 1.521116, 1.5272683, 1.5335034, 1.5398191, 1.546215, 1.5526953, 1.5592595, 1.565908, 1.572645, 1.5794694, 1.5863824, 1.5933881, 1.6004891, 1.6076795, 1.6149654, 1.6223553, 1.6298382, 1.6374248, 1.645109, 1.6529003, 1.6608003, 1.6688051, 1.6769217, 1.6851469, 1.6934855, 1.7019434, 1.7105148, 1.7192032, 1.7280194, 1.7369568, 1.7460229, 1.7552171, 1.7645409, 1.7739942, 1.7835914, 1.793326, 1.8031974, 1.8132145, 1.8233767, 1.8336922, 1.8426428, 1.8484635, 1.8543398, 1.8603007, 1.8663237, 1.8724401, 1.8786187, 1.8848767, 1.8912125, 1.8976344, 1.9041277, 1.910708, 1.9173665, 1.9241127, 1.9309309, 1.9378518, 1.9448451, 1.9519341, 1.9591112, 1.9663843, 1.9737384, 1.9811894, 1.9887295, 1.9963742, 2.004109, 2.0119567, 2.019887, 2.027931, 2.0360734, 2.044315, 2.0526714, 2.0611348, 2.069706, 2.0783923, 2.0871797, 2.096091, 2.1051188, 2.114264, 2.1235342, 2.1329148, 2.1424365, 2.1520617, 2.1618369, 2.171724, 2.1817544, 2.1919203, 2.2022305, 2.21267, 2.2232544, 2.233977, 2.2448459, 2.2558765, 2.2670546, 2.2783804, 2.28987, 2.3015165, 2.313328, 2.3253129, 2.3374565, 2.3497748, 2.3622687, 2.3749464, 2.387801, 2.4008486, 2.4140823, 2.427503, 2.4411268, 2.4549546, 2.468972, 2.483218, 2.497663, 2.5123312, 2.527223, 2.5423324, 2.5576756, 2.5732534, 2.5890749, 2.605141, 2.6214604, 2.6380348, 2.6548653, 2.6719756, 2.689345, 2.7070045, 2.7249413, 2.7431712, 2.7617037, 2.7805402, 2.7996902, 2.8191555, 2.838953, 2.8590841, 2.8795514, 2.900378, 2.9215527, 2.9431067, 2.965028, 2.987348, 3.0100546, 3.033172, 3.0567033, 3.0806592, 3.1050563, 3.129898, 3.155209, 3.1809864, 3.2072544, 3.2340243, 3.261299, 3.2891052, 3.3174617, 3.3463638, 3.3758447, 3.4059098, 3.436579, 3.467878, 3.499818, 3.5324218, 3.565705, 3.5996907, 3.6343992, 3.6698496, 3.7060707, 3.7431087, 3.7809355, 3.8196275, 3.8591824, 3.8996484, 3.9410372, 3.983403, 4.0267525, 4.0711493, 4.1166077, 4.163177, 4.210878, 4.2597775, 4.3099146, 4.361332, 4.4140596, 4.468178, 4.5237236, 4.580751, 4.629711, 4.660698, 4.692196, 4.7242184, 4.7567677, 4.789864, 4.8235106, 4.857728, 4.8925242, 4.927916, 4.963921, 5.00056, 5.0378437, 5.0757637, 5.1143675, 5.153662, 5.193669, 5.2343984, 5.2758718, 5.3181143, 5.3611374, 5.40495, 5.449608, 5.495116, 5.5414987, 5.58876, 5.6369586, 5.6861053, 5.7362194, 5.7873435, 5.8394914, 5.892699, 5.9470143, 6.0024247, 6.059028, 6.1168013, 6.175813, 6.2361097, 6.2976947, 6.3606267, 6.42498, 6.4907384, 6.5579944, 6.626825, 6.6971946, 6.7692404, 6.8429747, 6.918455, 6.9957447, 7.0749097, 7.1560616, 7.2392254, 7.324492, 7.4130425, 7.5243745, 7.639227, 7.7577753, 7.8802176, 8.006817, 8.137633, 8.272941, 8.41305, 8.558103, 8.708495, 8.864332, 9.026045, 9.194026, 9.36848, 9.549873, 9.738608, 9.935214, 17.335657, 17.183392, 17.034153, 16.887747, 16.7442, 16.603348, 16.465172, 16.329638, 16.190996, 16.04262, 15.897214, 15.754692, 15.615072, 15.478139, 15.34388, 15.212249, 15.083118, 14.956426, 14.832157, 14.710207, 14.590463, 14.472986, 14.357626, 14.244397, 14.133158, 14.02396, 13.916658, 13.81128, 13.707719, 13.605966, 13.505955, 13.3829, 13.173977, 12.971597, 12.775667, 12.585701, 12.401586, 12.22302, 12.049706, 11.881474, 11.718142, 11.559363, 11.405184, 11.255197, 11.109228, 10.967316, 4.068719, 3.9732177, 3.8821127, 3.7951732, 3.7121274, 3.6326468, 3.5566146, 3.4837854, 3.4138849, 3.3468437, 3.2824087, 3.220507, 3.1609108, 3.1035802, 3.0483477, 2.9950593, 2.9436886, 2.8941047, 2.846213, 2.7999234, 2.7551982, 2.7118886, 2.6700027, 2.6294253, 2.590109, 2.552018, 2.51504, 2.4791923, 2.4444082, 2.4106019, 2.3777795, 2.345871, 2.314868, 2.2847066, 2.2553754, 2.2268202, 2.1990137, 2.171941, 2.1455586, 2.1198597, 2.0948174, 2.070387, 2.046549, 2.0232997, 2.000616, 1.9784608, 1.9568378, 1.9357198, 1.9150792, 1.8949146, 1.8752096, 1.855949, 1.8371047, 1.8186755, 1.8006501, 1.7830139, 1.7657413, 1.748834, 1.732295, 1.716088, 1.7002139, 1.684664, 1.6694278, 1.6544955, 1.6398482, 1.6255001, 1.6114278, 1.5976298, 1.58474, 1.5778445, 1.571029, 1.564302, 1.5576676, 1.5511156, 1.5446469, 1.5382609, 1.531955, 1.5257334, 1.5195905, 1.5135216, 1.5075301, 1.5016165, 1.4957808, 1.4900118, 1.4843181, 1.4786986, 1.4731456, 1.4676639, 1.4622493, 1.4569004, 1.4516209, 1.4464046, 1.441253, 1.4361689, 1.4311442, 1.4261835, 1.4212816, 1.4164412, 1.4116609, 1.4069425, 1.4022771, 1.3976711, 1.3931205, 1.388626, 1.3841891, 1.379804, 1.3754724, 1.3711959, 1.3669714, 1.3627952, 1.3586732, 1.3546035, 1.3505778, 1.3466074, 1.3426843, 1.3388097, 1.3349786, 1.3311989, 1.3274641, 1.3237777, 1.3201332, 1.3165346, 1.3129818, 1.309472, 1.3060057, 1.3025836, 1.2992003, 1.2958627, 1.292568, 1.2893099, 1.2860943, 1.282921, 1.2797861, 1.2766905, 1.2736347, 1.2706159, 1.2676371, 1.2646956, 1.2617928, 1.258924, 1.2560954, 1.2533016, 1.2505441, 1.2478234, 1.2451366, 1.2424878, 1.2398709, 1.2372874, 1.2347403, 1.232226, 1.2297466, 1.2272997, 1.2248836, 1.2225037, 1.2201551, 1.2178377, 1.2155522, 1.2132987, 1.2110778, 1.2088857, 1.206725, 1.2045966, 1.2024957, 1.200426, 1.1983881, 1.1963782, 1.1943965, 1.1924443, 1.1905235, 1.1886289, 1.1867642, 1.1849279, 1.1831194, 1.1813372, 1.1795849, 1.1778595, 1.1761609, 1.1744907, 1.1728462, 1.1712295, 1.1696386, 1.1680752, 1.1665362, 1.1650252, 1.1635394, 1.1620806, 1.160646, 1.1592386, 1.1578546, 1.1564981, 1.1551654, 1.1538566, 1.1525745, 1.151315, 1.1500822, 1.1488726, 1.1476874, 1.1465272, 1.1453912, 1.1442779, 1.143189, 1.142124, 1.1410823, 1.1400654, 1.1390717, 1.1381009, 1.1371522, 1.1362271, 1.1353248, 1.134447, 1.1335909, 1.1327584, 1.1319475, 1.131161, 1.130396, 1.1296525, 1.1289341, 1.1282363, 1.1275598, 1.1269073, 1.1262753, 1.1256673, 1.1250806, 1.124515, 1.1239716, 1.1234515, 1.1229509, 1.122472, 1.1220176, 1.1215827, 1.1211725, 1.1207795, 1.1204095, 1.1200635, 1.1197356, 1.1194319, 1.1191467, 1.1188866, 1.1186434, 1.1184247, 1.1182271, 1.11805, 1.1178939, 1.1177598, 1.1176472, 1.1175549, 1.1174839, 1.1174351, 1.1174078, 1.1173999, 1.1174158, 1.1174513, 1.117508, 1.1175883, 1.1176851, 1.1178062, 1.1179477, 1.1181121, 1.1182967, 1.1185019, 1.118729, 1.1189783, 1.1192478, 1.1195403, 1.1198533, 1.1201859, 1.1205431, 1.12092, 1.1213189, 1.1217394, 1.1221828, 1.1226453, 1.1231325, 1.1236387, 1.1241671, 1.1247188, 1.1252934, 1.1258864, 1.1265051, 1.1271425, 1.1278045, 1.1284864, 1.1291939, 1.1299216, 1.1306729, 1.1314471, 1.1322427, 1.1330606, 1.1339012, 1.134765, 1.1356543, 1.1365627, 1.1374958, 1.1384523, 1.1394293, 1.1404356, 1.1414598, 1.1425103, 1.1435838, 1.1446811, 1.145802, 1.1469483, 1.1481185, 1.1493112, 1.1505308, 1.1517746, 1.1530402, 1.1543285, 1.155648, 1.1569918, 1.1583579, 1.1597514, 1.1611665, 1.162611, 1.1640787, 1.1655784, 1.167095, 1.1686429, 1.1702176, 1.1718184, 1.1734443, 1.1750966, 1.1767809, 1.1784875, 1.1802197, 1.1819844, 1.1837794, 1.185597, 1.1874449, 1.1893164, 1.1912237, 1.1931565, 1.1951169, 1.1971049, 1.1991293, 1.2011817, 1.20326, 1.2053691, 1.2075131, 1.2096869, 1.2118857, 1.2141178, 1.2163852, 1.2186795, 1.2210097, 1.2233716, 1.225762, 1.2281893, 1.2306483, 1.2331408, 1.2356696, 1.2382281, 1.2408224, 1.2434552, 1.2461177, 1.2488128, 1.2515483, 1.2543205, 1.2571243, 1.2599716, 1.2628508, 1.2657671, 1.268721, 1.2717125, 1.2747453, 1.277815, 1.2809265, 1.2840816, 1.2872657, 1.2904931, 1.2937697, 1.2970794, 1.3004339, 1.3038313, 1.3072691, 1.3107479, 1.3142742, 1.3178406, 1.3214599, 1.3251185, 1.3288219, 1.3325759, 1.336376, 1.3402209, 1.3441118, 1.3480505, 1.3520474, 1.3560878, 1.360172, 1.3643193, 1.3685092, 1.3727515, 1.3770492, 1.3813989, 1.3858013, 1.3902636, 1.3947786, 1.3993461, 1.4039743, 1.4086645, 1.4134017, 1.4182024, 1.4230658, 1.4279875, 1.4329754, 1.4380198, 1.4431286, 1.448305, 1.4535416, 1.4588469, 1.4642199, 1.4696603, 1.4751651, 1.4807423, 1.4863901, 1.4921118, 1.4979038, 1.503768, 1.5097125, 1.5157288, 1.5218252, 1.5279975, 1.5342523, 1.540585, 1.5470033, 1.5535002, 1.5600834, 1.566751, 1.5735099, 1.5803534, 1.5872885]
action = np.array([ 0.3974817 , -0.339167 ])

# Load model
model_path = 'logs/PPO-MlpPolicy-08-05-2023-16-51-19_best/best_model.zip'
model = PPO.load(model_path)

# Get reference to policy and perform inference
policy = model.policy
del model
resultant_action = policy.predict(obs, deterministic=True)
print(f"Resultant action / action: {resultant_action} / {action}")